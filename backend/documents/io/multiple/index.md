# Multiple


## Dealing with multiple files.


Polars can deal with multiple files differently depending on your needs and memory strain.


Let's create some files to give us some context:


 Python


 

```python

import polars as pl

df = pl.DataFrame({"foo": [1, 2, 3], "bar": [None, "ham", "spam"]})

for i in range(5):
    df.write_csv(f"docs/data/my_many_files_{i}.csv")

```






## Reading into a single `DataFrame`


To read multiple files into a single `DataFrame`, we can use globbing patterns:


 Python


 

```python

df = pl.read_csv("docs/data/my_many_files_*.csv")
print(df)

```









To see how this works we can take a look at the query plan. Below we see that all files are read separately and
concatenated into a single `DataFrame`. Polars will try to parallelize the reading.


 Python


 

```python

pl.scan_csv("docs/data/my_many_files_*.csv").show_graph()

```






![](data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAkgAAABRCAIAAACmOs6CAAAABmJLR0QA/wD/AP+gvaeTAAAbC0lEQVR4nO3de1QTVxoA8C8hIQkhhkeRIGJFutoq2EV0a60uCiIiIsqK6FJW18py9FSkVqtVq23t0WqtXbe1RWXZ+kDE2iMIuFVArAVCxQdypAK+6KICBh8QHokSZv+429lxQpIhvOP3+yu5c2fmmzsz+TIzd2Z4FEUBQgghZCn4vR0AQggh1JUwsSGEELIomNgQQghZFAHzy507dwoKCnorFIQQQsgMEyZMGDx48P+/UwwpKSm9FxhCCCFkjpSUFGYuE+jXwH6SCCGE+gsej8cqwWtsCCGELAomNoQQQhYFExtCCCGLgokNIYSQRcHEhhBCyKJ0KrEVFRUtWrTI3d1dIpE4ODh4enr+6U9/+uabb27evNlV8enT6XTx8fETJkyQy+VCoXDQoEEzZsz46quvKisrOxnh9evXeTze+PHjWeV1dXW833h7e2s0GkNDeTze2LFjDUU+ceJEnp64uDiTi3zt2rWIiAiFQiEQCMhYdnZ2ZNCOHTtIyTP3cPQUI4H1kTB6rH2OHDlCZiQWi7t1Rvry8vJ4PN7Zs2f7SEiG4kHG9YXNmKm4uDg4ONjOzk4mk02dOjU/P7/HZt0F9O9jozjQ6XSrVq0SCASrV6++du2aRqOpqak5ffr01KlTyWSfPn3KZTpmWLBgAZ/P37ZtW1VVVUtLy40bN9atW8fj8RwdHTsZ4fvvv08GlZaW6s+3qKiIDI2JidEfqlQqWQHoe+ONN/Tbf8WKFcbHun37tlwu9/Lyys/Pb2pqamhoOHr0qL29PbPOq6++6urqanw6XY5LYH0kjB5rH39/f5FI1AMzYlq9erWDg4OhPa7nQzIeD2pXn9qMKYoqLCyUSCQRERH37t1TqVTR0dECgeDUqVM9M/eOAr372MxMbOvWrQOAvXv3sspbW1uDgoK6L7GdP38eAKKjo1nly5YtY+WVjkao0+lcXV29vb0BYNWqVfqzLioqEolEjo6OAHD48GHWUI6JraioyHgdfSTdnjt3zkidXklsXAIzm1QqfeONN7oqDMtObMOHD4+KijI01IyQuDe+GfGgdvWpzVin040aNcrFxaW5uZmUtLa2jhgxws3NTaPR9EAAHaWf2Mw5FVlWVvbpp5/6+PhER0ezBllZWX3wwQdmTJOj0tJSABgxYgSrfN68eZ2M8PTp0wKBYO/evQBw8ODB1tZW/TpisTgpKYnP58fExFRUVHRmQbi7fv06AIwePbpnZsddHwmsj4TRW8rKyioqKkJDQ3s7kP/pa/H0F31qMz537lxpaencuXMlEgkpsbKyWrBgQVVVVUZGRu/GxpE5iW3v3r1tbW3h4eHtDn399dcpihII2nmmSec5OzsDQFZWFqvc19e3rq6uMxEmJiYuWrRo7Nixo0ePrq2tPXnyZLvjBgYGbtiwQa1Wh4eHsy62dZOnT58CgEgk6oF5dUgfCayPhNFb0tLSRCJRYGBgbwfyP30tnv6iT23GZ86cAQBWdwHyNScnp3di6iBzEtu5c+eA258LrVa7cePGl19+2cbGxsHBISQk5MSJEzqd7vHjx8wOFJ988gkAtLa20iVz585td4KTJk1SKBSnTp0KCgo6e/ZsW1tbJyMkHj58mJ6evnDhQgD461//CgCJiYmGKm/atGnatGklJSXLly/nOH3awYMHf//730ulUrlcPmnSpMOHDxupnJqayuPx0tLSAEAikbB6nSxatMjIuCqVKjY2dujQodbW1k5OTmFhYcXFxfRQQ+uF41JwCYzUIcrLy+fNm+fo6Ei+1tXVGQmAXCdvamrKz88n9Q39Seq+9uGorKxs9uzZcrlcKpVOmjQpLy9Pv86DBw9Wrlzp4eFhbW1tb28fFBSUm5vbbgWRSDR48OCpU6d+++23LS0twG01nThxws/Pz9bWlmNIra2tKSkpAQEBCoVCIpF4eXnt2rWL3o+MNL7xEfXjYW4Av/76a0REhEwmc3R0jIqKevToUWVlZUhIiEwmc3FxiY6OVqvVAGD2zwJhxhy5LBpzspWVlREREXZ2do6OjjNnziR90Lok7D61m5eVlQEAq6OKq6srABg/U2XGxtzJ1jOIeV6S4zU2FxcXAPj5559N1lyyZIlcLj99+nRzc3NNTc2qVasAIDc3lwydPn06n8+/ceMGc5TXX39d/woW008//eTm5kaCHzhwYGRk5OHDh5uamsyLkPjyyy+nTJlCPqtUKqFQKBAIamtrmXWKiorkcjldh8Rw6NAhUsLxGltUVNTFixcbGxvLysqioqIAYPny5cbHImd1Wlpa6BKVSgUACxcupEtYJ9/v3bv34osvOjs7Z2ZmqtXqq1ev+vr6isXigoICUsH4eqEoasqUKQ4ODkqlspOBkTq+vr65ublNTU2FhYVWVlYqlcpkANwv83RH+3BpgevXr9vZ2bm6up4+fVqtVpeUlEybNm3o0KHMC1rV1dXu7u7Ozs7p6en19fXl5eVhYWE8Hm/fvn3MCgqFIj09vaGhoaamZvPmzQDwxRdfUBxWU21tLZ/Pj4+P5x5Seno6AGzZsuXhw4cqleof//gHn89nXVRut/G5jMiKh147YWFhFy5caGxsPHDgAAAEBQWFhoZevnxZrVbHx8cDwDvvvEOPEhgY2O7PQlJSkqF1wWTGHLksGplsaGhoQUFBY2NjVlaWRCIZN25c14bdw7u5IQEBAQBQWFjILCQnS8eMGWNorM5szOblAhp0SecRkjbOnz9vsqa7u/uECROYJcOHD6cXJjs7GwCWLVtGD83LyxsyZIjJjicajWb//v2hoaEymYxkOEdHx+TkZDMiJMaMGXPgwAH665w5cwBgx44dzDrMxEZRlFKpFAqFUqn02rVrFLfEpu8Pf/iD/gbEYsYWTw49mXtUdXW1SCTy8fEhX42vF4qifH197e3tmT/05gVG6pw8eZI1rskAujWxmWwfikMLkBPdx44do0vu3r0rEomYWYT83WZumRqNZtCgQRKJpKamhq7A2ienT59OfgtMtlJCQgKPx7t79y73kNLT0ydPnsyc5ptvvikUCuvr6+kSQ4nN5IiseKjf1k5mZiZdMmrUKAD48ccf6RJ3d/cRI0bQX0+dOqX/s+Dq6vrkyROKAzPmyGXRyGTT09PpEnIkoVKpujDsHt7NDWk3sZFjNeY+wtKZjdnsXEB0TWLz8fFp99dK39KlSwEgOjpaqVS2trbqV/D29raxsamrqyNfQ0NDd+7caXKytKdPn+bk5MyfPx8ArKysLl261NEIKYq6cuWKTCZjHvOdOHECAEaNGsWsxkpsFEXt2rULADw9PZubm81LbNu3bweA9evXG6ljxhYvl8v5fD5zt6QoasyYMQBQVVVFcVgvXHBPbPT6pZkMoFsTm8n24YL8qVKr1cxCLy8vZhaRy+UA0NDQwKxDjtT3799vqALNZCuFhIQwDxq4hKTvs88+AwBmCufY+PojsuKhfls7zJMf5EeTubtNnDhRJpOxYmb9LHz66acm4+nMHE0uGpks+TtCvPPOOwBw5cqVLgy7j+zm5B9STk4Os/Dy5csA4O/vb2isTm7MnckF+onNnGtsvr6+AFBSUmKy5u7duw8cOHDr1i1/f/8BAwZMnz79+PHjzArvvvtuc3Pz119/DQAVFRXnzp1bsmQJ90gEAoGfn19ycvKaNWt0Ot2xY8c6GiEAJCYmqtVqqVRKn9WdNWsWAJSWlpK7CwyJjY2NiIi4evXq22+/zT1mJnJkef/+ffNGb5dWq62vr29ra5PL5cyT15cuXYLfOl+ZXC9dSyqVskp6OAAmLu3DZSJqtVosFtMXt4iBAweyZiQWi+nzCgTpAFVTU2OoAs14KzU3N2dnZ9P9D7mEBAD19fUbN2708vKyt7cnC7569WoyNeOLbHJEVjxMAwYMoD/z+XwrKysbGxu6xMrKinWtLi4ujvmzcObMmb/97W/Gw+vMHLm3CfntJqytrQGAOZ3Oh81dt+7mL7/8MgDcuXOHWXj37l0AGD58uJF4zN6YodO5gMWcxBYTEyMQCOgswvLee+/x+Xxy+ZHH40VFRWVnZz9+/Dg1NZWiqLCwsJ07d9KVIyIi3NzcvvrqK61W+/nnn0dHRxtqFyI/P5/8LrBMmTIFAB49etTRCJ8+fZqUlJSfn8/6C0AeCPKvf/3LeFMkJCSMGDEiMTHx4MGDxmu26969e6D309NJIpHIzs5OIBC0exRPGsrkeuluJgPg6b1gqatwaR8uE5HJZBqNprGxkVn+8OFDZh25XK7RaJj9FACgtrYWABQKhaEKNOOtlJWV1dLSQicSLiEBQEhIyObNm6OjoysqKtra2iiK+uKLL+DZtzC22/gmR2TF0xmRkZHOzs70z8LChQvt7e07P1lDuLQJFz0Zdrfu5mT0ixcvMgvJV39/f0PxdGZjho7nAuPMSWzDhw/ftGnThQsX9LsOlpeX79mzZ968eSTn29nZkfwhFAoDAgJI/5/MzEy6vkAgWLFixf379z///PMjR47ExsYanzVFUffv3y8sLGSVX7hwAQDI7dUdijA9Pf2FF16YMGECq9pbb70FAMnJyaRLjyG2trbff/+9VColfzSMSEhIICdImcty9OhRAAgJCTE+bkeFhYW1trayHoGzbdu2IUOGkPvzTK6X7mYyABsbmydPnpDPI0aMIPcXdhWT7cMFuc3/hx9+oEvq6urKy8uZdcjFWuZyabXanJwciURCOsSTCqx7S7y9vclpLuOtlJaWNmzYME9PT+4h6XS6/Px8hUIRGxvr5OREEpj+Fq7f+FxG1I/HbCKRaNmyZeRnISkpacWKFZ2fpiEc24SLngwbunM39/X1HTly5LFjx+g7mnQ63ZEjR9zc3IKDgw2N1ZmNGTqeC0xg5nnuTx6hKGrt2rVCoXDNmjXl5eVarfbOnTsJCQkuLi4TJ05sbGwkdeRyua+v75UrVzQaTW1t7YcffggAn3zyCXM6DQ0N5Gj6L3/5i8mZ/vTTTwDg5uaWlJR09+5djUZz+/btzz77zNra2sfHh3VXPJcIZ86cuX379nbnRXp20P0e9a+x0Q4dOgQAxq+x7du3DwCWLVt2/fr1lpaWsrKyyMhI6J5ekbW1tR4eHsOGDTt58uTjx48fPHgQHx9vY2NDn4Y2uV66tlcksw7HAKZPny6Xy//zn/8UFBQIBIJffvmlJ9uHSwvcuHHDwcGB7oJYWloaGBg4cOBAQ70iGxoa6F6R9ANxSAUXF5eMjIyGhoaqqqqlS5c6Ozv/+uuvxltJp9M5OTnFxcV1NCQ/Pz8A2L59u0qlam5uPnPmzJAhQwAgKyvLeOMbH7HdeNpdO4GBgVZWVsw6vr6+UqmUNaJKpSJ930NDQw2tgnaZMUcubaI/2TVr1gDA5cuXuynsHtjNjVAqlWKxeP78+dXV1XV1deQc2A8//EBXuH37Np/PB4CLFy+SErM3ZlqHcgETdNUjtYjz589HRUW5ubkJhUKZTDZ+/Phdu3ZptVq6QnFxcUxMzCuvvELuXRg/fvy+ffvIwT4TOaPNvAxriE6ny8vLW7Vq1WuvvTZo0CCBQCCTycaOHbtlyxZWj3+TEVZVVdHZ/bXXXmOOdfv2bWbut7KyYn5tt1/Q0qVLjSc2jUbz3XffzZkzh9zkIZfLJ0+ebLwzK+scdGRkJEVRrFtfWWd+6H4o5IaSYcOGCYVCJyenadOmMfdSk+tl0qRJRvoEcgmMXH5nYk7BZABlZWWTJk2SSqVubm67d+/u4fYx2QJEeXn57NmzBwwYQHp+Z2Rk0Cdq3nrrLVKnrq4uLi7O3d1dKBTK5fLAwEDWNXlmBRcXl/nz51dUVJhsJXKDmn4PN5MhqVSqmJgYskc4OzsvWrRo7dq1rA273cY3PqJ+PEqlktXy9NNWia1bt5L/qbRNmzYxl4U8NojZm9E4s+dofNH0J0s9e4oyODi4M2H34m5u3KVLl4KCggYMGGBra+vn55eXl8ccShIbj8crKSmhC83bmJm45wIm6NrEhhDqFX3tQcPdEU9iYqKRzuV9Vj8Nu1/TT2z4PjaE+p+0tLQZM2Z004PrzNAd8cTHx69cubILJ9gz+mnYFqav7BgIIe5YvVR6XVfFk5CQkJmZefDgwUOHDj169Ij1cPM+q5+GbcHwiA0h1Iekpqba29t/8803R44c0T8E5BlG+iP0lv4Vdl+Lp8vxKMaF0KNHj0ZERFAdvHsDIYQQ6i08Hi8lJYV5oIxHbAghhCwKJjaEupGHh0dSUlK7g/Ly8ng83tmzZx89ehQfH+/n5+fg4CCRSH73u99FRkZeuXKlh0NFyGJgYkOoG4nFYkNvjzxx4oSDg8PEiRNXr169fPny0NDQX3755cGDB4mJicXFxT4+PqmpqT0cLUKWARMbQl0sJSWFvIoWAMhbY548ebJz584pU6bQj6oCgLS0tODgYNLRYPHixStWrFAoFDY2NuQNtDqd7r333uu1ZUCoP8Pu/gh1scmTJ1dUVISEhAQEBGg0mqysrFWrVo0cOXLdunVCoZDUKSsrq6io2LJlCwAkJCSwpvDqq69KJJKbN29SFNV9z4NGyFLhERtCXczZ2fmDDz6oqKh4+vTptWvXkpOTExISjh8/HhAQQGeptLQ0kUjEenISrampqaWlxdPTE7MaQmbAxIaQQeQZ5EaMHTtWf6z79+9v3bp15MiRAoHglVdeWbBgweLFi2fNmnX69Gn6XpoTJ074+fmx3p1G++677wBg/fr13bdoCFkwTGwIGTR79mzK6JPdyfuSWHJzc8+cOXP8+PF//vOfYrE4ICCgtLTU19d369at5BobefWSoVeX1dbWrl27dsmSJawHWISEhNjb2+fm5nb9ciJkWTCxIdTFIiIisrKyRo8eDQBarVar1VpbW7/77ru5ubmkh2R6ejpFUe2+h+/BgwfTp0+fPHlyfHw8axD9KPQeWASE+jXsPIJQN9JqtfTbGmlpaWljx44dNGgQq7ypqSkwMHDkyJEHDhxgvSwJnn1hKULICExsCHWjGzdusEqam5uzs7P1r5+1traGh4e7urru379fP6shhLjDU5EI9aisrKyWlhb9C2wxMTFarfbo0aP0I3RfeumlwsLCHg8QoX4Pj9gQ6lFpaWnDhg3z9PRkFn744YelpaXZ2dmGHlOCEOIOj9gQ6jltbW0ZGRmzZs1iFn777bcfffTRzz//LJPJmPcS3Lx5k1ntzTff5PF4t2/f7tmQEep/MLEhZFBhYSGPx0tLSwMAiUSyYcMGAODxeNu2bQMAb2/vmTNndmiCSqVSpVKxzkMeO3aMy7jV1dW2trZDhgzp0BwReg7hqUiEDBo/frx+9/rOdLhPS0sjDz5mFmZkZJgc8fHjx0qlMjIyEvuVIGQSHrEh1HPS0tJmzJih/4Zl4yiKio2NHTBgwObNm7spMIQsCR6xIdRzysvLzRirtrb21q1bOTk5CoWiy0NCyPJgYkOor1MoFHl5eb0dBUL9Bp6KRAghZFEwsSGEELIomNgQMlNdXR19z5m3tzfrmZDMoYZecIMQ6g6Y2BAy0wsvvEBRVFFREQAUFxfHxcXpD1UqlY6OjhRFtfuCG4RQd8DEhlBniUQiR0fHPXv2JCcn93YsCCFMbAh1mlgsTkpK4vP5MTExFRUVvR0OQs87TGwIAQA8fvz4448/njJlipeX10t6TB6KBQYGbtiwQa1Wh4eH67+ADSHUkzCxIQRqtXrChAm7d+/+6KOPSkpKzpw54+npefPmzaVLl2ZnZ2dnZ3N5JuSmTZumTZtWUlKyfPlyI9UePHiwcuVKDw8Pa2tre3v7oKCg3NxcMig1NZXubFJZWRkREWFnZ+fo6Dhz5kzWA5FVKlVsbOzQoUOtra2dnJzCwsKKi4s70wIIWRSKISUlhVWC0PPg/fffB4Avv/ySLlGr1VKpdODAgc3NzcbHLSoqksvl5LNKpXJzcwOAQ4cOkRK68whRXV3t7u7u7Oycnp5eX19fXl4eFhbG4/H27dtH1yGPSA4NDS0oKGhsbMzKypJIJOPGjaMr3Lt378UXX3R2ds7MzFSr1VevXvX19RWLxQUFBZ1vCoT6HQBISUl5poT5BRMbej55eHgAwN27d5mFs2fPBoDMzEzj4zITG0VRSqVSKBRKpdJr165Reolt0aJFAJCcnEyXaDSaQYMGSSSSmpoaUkISW3p6Ol1n7ty5AKBSqcjXhQsXAkBSUhJdobq6WiQS+fj4dHTBEbIA+okNT0Wi551Op7t165ZAIGA9iZEce3W0M8j48eN37NjR1NQUHh7e0tLCGnr8+HEACA4OpktEIpG/v39LS8upU6eYNceNG8eK5N69e+Rramoqn89nnh1VKBSjRo26ePHinTt3OhQtQhYJExt63pG/eCKRiM9/ZneQSCQAoNPpOjrB2NjYiIiIq1evvv3228xyrVZbX18vFotlMhmz3NnZGQBqamqYhXK5nP5sbW0NAG1tbfRE2tra5HI58wbwS5cuAcD169c7Gi1ClgcfgoyedwKBYPDgwXfu3FGr1cyUQzKNu7u7GdNMSEgoLi5OTEwUi8V0oUgkksvl9fX1rBnV1tYCAMcn94tEIjs7u8bGxpaWlo6+/gah5wQesSEE5HLajz/+SJdQFHXu3DmZTObv72/GBG1tbb///nupVPr1118zy+fMmQMAmZmZdIlWq83JyZFIJIGBgRwnHhYW1tramp+fzyzctm3bkCFDWltbzYgWIQuDiQ0hWL9+vUKh2LhxY0NDAyn5+9//XllZuWXLFuYpwQ4ZNWrUnj17WIVbt251d3ePi4vLyMhQq9UVFRV//vOfq6urd+3aRU5IcrF161YPD4/Fixf/+9//rq+vf/jw4Z49ez7++OMdO3bgMRxCANjdHyGKoiiqoqLij3/8o5OT0+zZs8eNG+fo6BgfH298FJVKxdyV2u2UuHTpUmavSIqi6urq4uLi3N3dhUKhXC4PDAzMyckhg5RKJXOC69evpyiKWRIcHExqkpvhhg0bJhQKnZycpk2blpWV1QWtgFA/BHq9InkUY885evRoREQE9ey+hNDzo6qqqrKy0tbW1svLC49+EOoXeDxeSkrKvHnz6BLcdRH6Pzc3N9K3HiHUf+E1NoQQQhYFExtCCCGLgokNIYSQRcHEhhBCyKJgYkMIIWRRMLEhhBCyKJjYEEIIWZR27mMLDw/v+TgQQgihLvHMEZubmxt5pSFCCCHUL8ydO5f1XAUePkALIYSQJcFrbAghhCwKJjaEEEIWBRMbQgghi/JfOs6wDfiVMlMAAAAASUVORK5CYII=)


## Reading and processing in parallel


If your files don't have to be in a single table you can also build a query plan for each file and execute them in parallel
on the Polars thread pool.


All query plan execution is embarrassingly parallel and doesn't require any communication.


 Python


 

```python

import glob

import polars as pl

queries = []
for file in glob.glob("docs/data/my_many_files_*.csv"):
    q = pl.scan_csv(file).group_by("bar").agg(pl.len(), pl.sum("foo"))
    queries.append(q)

dataframes = pl.collect_all(queries)
print(dataframes)

```







